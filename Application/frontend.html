<!DOCTYPE html>
<head>
    <title>LFB Animal Rescue</title>
    <link href = "../YASQE/dist/yasqe.min.css" rel = "stylesheet" type ="text/css"/>
    <link href = "../YASQE/doc/doc.min.css" rel = "stylesheet" type ="text/css"/>
    <link href = "../YASR/dist/yasr.min.css" rel = "stylesheet" type ="text/css"/>
    <link href = "../YASR/doc/doc.min.css" rel = "stylesheet" type ="text/css"/>
    <link href = "style.css" rel = "stylesheet" type ="text/css"/>

</head>
<body>
<div id = "queryDiv"></div>

<button onclick="runPrebuiltQuery('query1')">check Incident time and place</button>
<button onclick="runPrebuiltQuery('query2')">ckeck the average, maximum and minimum CallOutTimes for a Ward containing the Borough name </button>
<button onclick="runPrebuiltQuery('query3')">check incident location, date, and description </button>
<button onclick="runPrebuiltQuery('query4')">check incident location, date, and involved animals </button>
<button onclick="runPrebuiltQuery('query5')">check every incident where an animal was stuck </button>
<button onclick="runPrebuiltQuery('query6')"> </button>
<button onclick="runPrebuiltQuery('query7')"> </button>
<button onclick="runPrebuiltQuery('query8')"> </button>
<button onclick="runPrebuiltQuery('query9')"> </button>
<button onclick="runPrebuiltQuery('query9')"> </button>
<div id = "resultDiv"></div>
<script src = " ../YASQE/dist/yasqe.bundled.min.js"></script>
<script src = "../YASQE/doc/doc.min.js"></script>
<script src = "../YASR/dist/yasr.bundled.min.js"></script>
<script src = "../YASR/doc/doc.min.js"></script>

<textarea id = "query1" style="display: none">
   SELECT ?time ?area
WHERE{
	<http://www.example.org/Incident/000481-01012019/Date> <http://www.example.org/Incident/time> ?time.
	<http://www.example.org/Incident/000481-01012019/LFB>  <http://www.example.org/Incident/attendedFrom> ?area .
} LIMIT 100
</textarea>

<textarea id = "query2" style="display: none">
  PREFIX incident: <http://www.example.org/Incident/>

	SELECT (AVG(?callHour) as ?avg_call_hour) (MAX(?callHour) as ?max_call_hour) (MIN(?callHour) as ?min_call_hour) WHERE {
  	?callAt incident:hour ?callHour . {
		SELECT ?callAt WHERE {
  		?incident incident:callAt ?callAt . {
			SELECT ?incident WHERE {
  				?incident incident:reportedIn ?area . {
    				SELECT ?area  WHERE {
    					?area incident:ward ?ward .
              			?area incident:borough ?borough .
              FILTER(CONTAINS(?ward, ?borough))
            }
          }
        }
      }
    }
  }
}

</textarea>

<textarea id = "query3" style="display: none">
     SELECT ?involvedAnimal ?place ?postcodeddistrict ?date
	WHERE{
		?Incident <http://www.example.org/Incident/animal> ?Animal.
  		?Animal <http://www.example.org/Incident/involved> ?involvedAnimal.
  		?Incident <http://www.example.org/Incident/reportedIn> ?reportedIn.
  		?LFB <http://www.example.org/Incident/borough> ?place.
  		?LFB <http://www.example.org/Incident/postcodedistrict> ?postcodeddistrict.
  		?Incident <http://www.example.org/Incident/callAt> ?callAt.
  		?callAt <http://www.example.org/Incident/date> ?date
  		}LIMIT 10
</textarea>

<textarea id = "query4" style="display: none">
  	SELECT ?Borough ?PostCodeDistrict ?description ?date
	WHERE{
		?LFB <http://www.example.org/Incident/borough> ?Borough.
  		?LFB <http://www.example.org/Incident/postcodedistrict> ?PostCodeDistrict.
  		?Incident <http://www.example.org/Incident/description> ?description.
  		?Incident <http://www.example.org/Incident/callAt> ?callAt.
  		?callAt <http://www.example.org/Incident/date> ?date
	}LIMIT 10
</textarea>

<textarea id = "query5" style="display: none">
PREFIX incident: <http://www.example.org/Incident/>
SELECT ?animal ?incident WHERE{
  ?animalTriple incident:involved ?animal .{
    SELECT ?animalTriple ?incident WHERE{
     	 ?incident incident:animal ?animalTriple .{
   		 SELECT ?incident WHERE {
     			 ?incident incident:description ?string .FILTER regex(str(?string), "STUCK") .
   		 }
     	 }
	}
  }
}
LIMIT 100

</textarea>

<textarea id = "query6" style="display: none">

</textarea>

<textarea id="query7" style="display: none">

</textarea>

<textarea id="query8" style="display: none">

</textarea>

<textarea id="query9" style="display: none">

</textarea>

<textarea id="query10" style="display: none">

</textarea>
<script type = "text/javascript">

    function runPrebuiltQuery(query) {
        var q = document.getElementById(query).value;
        yasqe.setValue(q);
    }

    var yasqe = YASQE(document.getElementById('queryDiv'), {
        sparql: {
            endpoint:"http://35808e14.ngrok.io/dataset.html?tab=upload&ds=/lfb",
            showQueryButton: true,
            callbacks:{
                success:function(data){
                    console.log("success", data);
                }
            }
        }
    });

    var yasr = YASR(document.getElementById("resultDiv"), {
        getUsedPrefixes: yasqe.getUsedPrefixesFromQuery
    });
    yasqe.options.sparql.callbacks.complete = yasr.setResponse;


</script>
</body>